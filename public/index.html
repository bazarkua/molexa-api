<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>moleXa Educational API - Documentation & Analytics</title>
    
    <!-- Favicons and Web App Manifest -->
    <link rel="icon" type="image/x-icon" href="/public/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/public/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/public/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="192x192" href="/public/android-chrome-192x192.png">
    <link rel="manifest" href="/public/site.webmanifest">
    <meta name="msapplication-TileColor" content="#007bff">
    <meta name="theme-color" content="#ffffff">
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Hero section with more space from navbar */
        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 6rem 0 4rem 0;
            margin-top: 76px;
        }
        
        /* Navbar styling for light theme */
        .navbar-light {
            background-color: #f8f9fa !important;
            border-bottom: 1px solid #e9ecef;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .navbar-light .navbar-brand {
            color: #2c3e50 !important;
            font-weight: 600;
            font-size: 1.25rem;
        }
        
        .navbar-light .navbar-brand:hover {
            color: #007bff !important;
        }
        
        /* Enhanced nav link styling for light theme */
        .navbar-light .navbar-nav .nav-link {
            color: #495057 !important;
            font-weight: 500;
            padding: 0.75rem 1rem;
            border-radius: 6px;
            margin: 0 0.25rem;
            transition: all 0.3s ease;
        }
        
        .navbar-light .navbar-nav .nav-link:hover {
            color: #007bff !important;
            background-color: rgba(0, 123, 255, 0.1);
            transform: translateY(-1px);
        }
        
        .navbar-light .navbar-nav .nav-link.active {
            color: #007bff !important;
            background-color: rgba(0, 123, 255, 0.15);
            font-weight: 600;
        }
        
        /* GitHub star button styling */
        .github-star-btn {
            border: 1.5px solid #24292e !important;
            color: #24292e !important;
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            transition: all 0.3s ease;
            text-decoration: none !important;
            display: inline-flex;
            align-items: center;
            font-size: 0.875rem;
        }
        
        .github-star-btn:hover {
            background-color: #24292e !important;
            color: white !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(36, 41, 46, 0.2);
        }
        
        .code-block {
            background-color: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 1rem;
            border-radius: 0.25rem;
        }
        .endpoint-card {
            border-left: 4px solid #28a745;
            transition: transform 0.2s;
        }
        .endpoint-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .method-badge {
            font-size: 0.8rem;
            padding: 0.25rem 0.5rem;
        }
        .nav-pills .nav-link.active {
            background-color: #007bff;
        }
        .citation-box {
            background-color: #e7f3ff;
            border-left: 4px solid #007bff;
            padding: 1.5rem;
            border-radius: 0.25rem;
        }
        .feature-icon {
            font-size: 2rem;
            color: #007bff;
        }
        .footer {
            background-color: #343a40;
            color: white;
            padding: 2rem 0;
        }
        .property-example {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 0.25rem;
            padding: 1rem;
            margin: 0.5rem 0;
        }
        
        /* Enhanced link styling for better readability */
        a {
            color: #0066cc;
            text-decoration: none;
            transition: color 0.2s ease;
        }
        a:hover {
            color: #004499;
            text-decoration: underline;
        }
        
        /* Smooth scrolling offset for fixed navbar */
        html {
            scroll-padding-top: 90px;
        }
        
        /* Additional spacing for sections */
        section {
            scroll-margin-top: 90px;
        }
        
        /* ===== ANALYTICS STYLING ===== */
        .analytics-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4rem 0;
        }
        
        .stat-card {
            transition: transform 0.2s;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .recent-request {
            border-left: 3px solid #007bff;
            background: white;
            margin-bottom: 0.5rem;
            padding: 0.75rem;
            border-radius: 0.375rem;
            transition: all 0.3s ease;
        }
        
        .recent-request.new {
            border-left-color: #28a745;
            box-shadow: 0 0 15px rgba(40, 167, 69, 0.3);
        }
        
        .activity-feed {
            height: 350px;
            overflow-y: auto;
            background: #f8f9fa;
            border-radius: 0.5rem;
            padding: 1rem;
        }
        
        .badge-request-type {
            font-size: 0.7rem;
            padding: 0.25rem 0.5rem;
        }
        
        .analytics-card {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #28a745;
            animation: pulse 2s infinite;
        }
        
        /* Navbar responsive improvements */
        @media (max-width: 991.98px) {
            .hero-section {
                margin-top: 76px;
                padding: 4rem 0 3rem 0;
            }
            
            .navbar-collapse {
                margin-top: 0.5rem;
                padding: 1rem 0;
                background-color: #f8f9fa;
                border-radius: 8px;
                border: 1px solid #e9ecef;
            }
            
            .navbar-light .navbar-nav .nav-link {
                margin: 0.25rem 0;
            }
            
            .github-star-btn {
                margin-top: 0.5rem;
                justify-content: center;
                width: 100%;
            }
        }
        
        @media (max-width: 576px) {
            .github-star-btn span {
                display: none !important;
            }
            
            .hero-section .btn {
                display: block;
                width: 100%;
                margin: 0.5rem 0 !important;
            }
        }

        /* Warning alert styling */
        .alert-connection {
            border: 2px solid #ffc107;
            background-color: #fff3cd;
            color: #856404;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#home">
                <img src="/public/android-chrome-192x192.png" alt="moleXa Logo" style="width: 48px; height: 48px; margin-right: 10px;">
                moleXa API
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="#overview">Overview</a></li>
                    <li class="nav-item"><a class="nav-link" href="#analytics">Live Analytics</a></li>
                    <li class="nav-item"><a class="nav-link" href="#endpoints">Endpoints</a></li>
                    <li class="nav-item"><a class="nav-link" href="#examples">Examples</a></li>
                    <li class="nav-item"><a class="nav-link" href="#citations">Citations</a></li>
                    <li class="nav-item"><a class="nav-link" href="#license">License</a></li>
                    <li class="nav-item ms-2">
                        <a href="https://github.com/bazarkua/molexa-api" target="_blank" class="btn btn-outline-dark btn-sm github-star-btn">
                            <i class="fab fa-github me-1"></i>
                            <span class="d-none d-md-inline">Star on GitHub</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="display-4 fw-bold mb-4">
                        <img src="/public/android-chrome-192x192.png" alt="moleXa Logo" style="width: 64px; height: 64px; margin-right: 18px; vertical-align: middle;">
                        moleXa Educational API
                    </h1>
                    <p class="lead mb-4">
                        Enhanced proxy server for PubChem molecular data with educational context, autocomplete search, 
                        and real-time analytics. Designed specifically for chemistry education and research.
                    </p>
                    <div class="d-flex flex-wrap gap-3">
                        <span class="badge bg-light text-dark px-3 py-2">
                            <i class="fas fa-database me-1"></i>PubChem Proxy
                        </span>
                        <span class="badge bg-light text-dark px-3 py-2">
                            <i class="fas fa-search me-1"></i>Smart Autocomplete
                        </span>
                        <span class="badge bg-light text-dark px-3 py-2">
                            <i class="fas fa-graduation-cap me-1"></i>Educational Data
                        </span>
                        <span class="badge bg-light text-dark px-3 py-2">
                            <i class="fas fa-chart-line me-1"></i>Live Analytics
                        </span>
                    </div>
                </div>
                <div class="col-lg-4 text-center">
                    <div class="bg-white bg-opacity-10 rounded-3 p-4">
                        <h3>API Status</h3>
                        <div class="d-flex justify-content-center align-items-center">
                            <div class="status-indicator">
                                <div class="status-dot" id="statusDot"></div>
                                <span class="badge fs-6 px-3 py-2" id="statusBadge">Checking...</span>
                            </div>
                        </div>
                        <small class="d-block mt-2">Base URL: <br/> <code>https://molexa-api.vercel.app/api</code></small>
                        <div class="mt-3">
                            <small class="d-block">Total API Requests:</small>
                            <strong class="h4" id="heroTotalRequests">Loading...</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Overview Section -->
    <section id="overview" class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <h2 class="text-center mb-5">
                        <i class="fas fa-info-circle text-primary me-2"></i>
                        What This API Actually Does
                    </h2>
                </div>
            </div>
            <div class="row g-4">
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 text-center border-0 shadow-sm">
                        <div class="card-body">
                            <i class="fas fa-database feature-icon mb-3"></i>
                            <h5>PubChem Proxy</h5>
                            <p class="text-muted">Direct proxy to PubChem REST API with enhanced error handling, caching, and rate limiting for educational use.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 text-center border-0 shadow-sm">
                        <div class="card-body">
                            <i class="fas fa-search feature-icon mb-3"></i>
                            <h5>Smart Search</h5>
                            <p class="text-muted">Chemical name autocomplete and enhanced formula search using PubChem's FastFormula endpoint.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 text-center border-0 shadow-sm">
                        <div class="card-body">
                            <i class="fas fa-graduation-cap feature-icon mb-3"></i>
                            <h5>Educational Context</h5>
                            <p class="text-muted">Combines molecular data with educational explanations, safety information, and synonyms from PubChem.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 text-center border-0 shadow-sm">
                        <div class="card-body">
                            <i class="fas fa-chart-line feature-icon mb-3"></i>
                            <h5>Usage Analytics</h5>
                            <p class="text-muted">Real-time tracking of API usage with selective analytics, database storage, and live streaming dashboard.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Key Features -->
            <div class="row mt-5">
                <div class="col-12">
                    <h3 class="mb-4">Actual Features & Capabilities</h3>
                    <div class="row">
                        <div class="col-lg-6">
                            <ul class="list-unstyled">
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Enhanced PubChem data access with educational context</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Chemical name autocomplete (8 suggestions max)</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Rate limiting (5 requests/second) for responsible API usage</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Response caching (24 hours) for improved performance</li>
                            </ul>
                        </div>
                        <div class="col-lg-6">
                            <ul class="list-unstyled">
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Real-time usage analytics with database persistence</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>CORS-enabled for cross-origin educational applications</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Selective analytics (only tracks actual API usage)</li>
                                <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Server-Sent Events for live dashboard updates</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Live Analytics Section -->
    <section id="analytics" class="analytics-section">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center mb-5">
                    <h2 class="display-5 fw-bold mb-3">
                        <i class="fas fa-chart-line me-3"></i>
                        Live API Usage Analytics
                    </h2>
                    <p class="lead">
                        Real-time monitoring of educational API usage with selective tracking of actual PubChem requests
                    </p>
                    <div id="connectionAlert" class="alert alert-connection d-none mt-3">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        Unable to connect to analytics stream. Showing cached data only.
                    </div>
                </div>
            </div>

            <!-- Stats Row -->
            <div class="row mb-4">
                <div class="col-md-3 mb-3">
                    <div class="card stat-card border-0 text-center h-100">
                        <div class="card-body">
                            <i class="fas fa-flask fa-2x mb-3"></i>
                            <h3 class="mb-0" id="totalRequests">0</h3>
                            <p class="mb-0 opacity-75">Total API Requests</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card stat-card border-0 text-center h-100">
                        <div class="card-body">
                            <i class="fas fa-search fa-2x mb-3"></i>
                            <h3 class="mb-0" id="searchRequests">0</h3>
                            <p class="mb-0 opacity-75">Search & Autocomplete</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card stat-card border-0 text-center h-100">
                        <div class="card-body">
                            <i class="fas fa-graduation-cap fa-2x mb-3"></i>
                            <h3 class="mb-0" id="educationalRequests">0</h3>
                            <p class="mb-0 opacity-75">Educational Data</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card stat-card border-0 text-center h-100">
                        <div class="card-body">
                            <i class="fas fa-image fa-2x mb-3"></i>
                            <h3 class="mb-0" id="imageRequests">0</h3>
                            <p class="mb-0 opacity-75">Structure Images</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <!-- Recent Activity -->
                <div class="col-lg-8 mb-4">
                    <div class="card analytics-card border-0">
                        <div class="card-header bg-white border-0 pb-0">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">
                                    <i class="fas fa-activity text-primary me-2"></i>
                                    Recent API Requests
                                </h5>
                                <div class="status-indicator">
                                    <div class="status-dot" id="activityStatusDot"></div>
                                    <small class="text-muted" id="streamStatus">Connecting...</small>
                                </div>
                            </div>
                        </div>
                        <div class="card-body pt-2">
                            <div class="activity-feed" id="activityFeed">
                                <div class="text-center text-muted">
                                    <i class="fas fa-hourglass-half fa-2x mb-3"></i>
                                    <p>Loading recent activity...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- API Usage Insights -->
                <div class="col-lg-4 mb-4">
                    <div class="card analytics-card border-0 h-100">
                        <div class="card-header bg-white border-0">
                            <h5 class="mb-0">
                                <i class="fas fa-chart-pie text-success me-2"></i>
                                Request Types
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="requestTypes">
                                <div class="text-center text-muted">
                                    <i class="fas fa-chart-bar fa-2x mb-3"></i>
                                    <p>Loading usage data...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Educational Impact Note -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card analytics-card border-0">
                        <div class="card-body">
                            <div class="row text-center">
                                <div class="col-12">
                                    <p class="text-muted mb-0">
                                        <i class="fas fa-info-circle text-primary me-1"></i>
                                        Analytics tracks only actual API usage (PubChem requests, autocomplete, educational data) - 
                                        not documentation views or health checks. Data is privacy-protected with hashed IPs.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Endpoints Section -->
    <section id="endpoints" class="py-5 bg-light">
        <div class="container">
            <h2 class="text-center mb-5">
                <i class="fas fa-code text-primary me-2"></i>
                Available API Endpoints
            </h2>

            <!-- Endpoint Categories -->
            <ul class="nav nav-pills justify-content-center mb-4" id="endpointTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="core-tab" data-bs-toggle="pill" data-bs-target="#core" type="button">
                        <i class="fas fa-home me-1"></i>Core
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="educational-tab" data-bs-toggle="pill" data-bs-target="#educational" type="button">
                        <i class="fas fa-graduation-cap me-1"></i>Educational
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="search-tab" data-bs-toggle="pill" data-bs-target="#search" type="button">
                        <i class="fas fa-search me-1"></i>Search
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="analytics-tab" data-bs-toggle="pill" data-bs-target="#analytics-endpoints" type="button">
                        <i class="fas fa-chart-line me-1"></i>Analytics
                    </button>
                </li>
            </ul>

            <!-- Tab Content -->
            <div class="tab-content" id="endpointTabsContent">
                <!-- Core Endpoints -->
                <div class="tab-pane fade show active" id="core" role="tabpanel">
                    <div class="row g-4">
                        <div class="col-lg-6">
                            <div class="card endpoint-card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-primary method-badge me-2">GET</span>
                                        Health Check
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/health</code>
                                    </div>
                                    <p class="mt-3">Check API service status, cache statistics, and available features.</p>
                                    <small class="text-muted">Returns service health, analytics summary, and feature list.</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="card endpoint-card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-primary method-badge me-2">GET</span>
                                        PubChem Proxy
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/pubchem/*</code>
                                    </div>
                                    <p class="mt-3">Direct proxy to PubChem PUG-REST API with enhanced error handling.</p>
                                    <small class="text-muted">All PubChem endpoints supported with educational context added to property requests.</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="card endpoint-card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-primary method-badge me-2">GET</span>
                                        Interactive Documentation
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/docs</code>
                                    </div>
                                    <p class="mt-3">Interactive HTML documentation with live analytics dashboard.</p>
                                    <small class="text-muted">Complete API documentation with real-time usage examples.</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="card endpoint-card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-primary method-badge me-2">GET</span>
                                        JSON API Specs
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/json/docs</code>
                                    </div>
                                    <p class="mt-3">Machine-readable API specification in JSON format.</p>
                                    <small class="text-muted">Complete endpoint listing with examples and feature descriptions.</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Educational Endpoints -->
                <div class="tab-pane fade" id="educational" role="tabpanel">
                    <div class="row g-4">
                        <div class="col-12">
                            <div class="card endpoint-card">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-success method-badge me-2">GET</span>
                                        Enhanced Educational Data
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/pubchem/compound/{identifier}/educational?type={cid|name|fastformula}</code>
                                    </div>
                                    <p class="mt-3">Comprehensive educational data combining multiple PubChem sources:</p>
                                    <ul class="mt-2">
                                        <li>Basic molecular properties with educational explanations</li>
                                        <li>Alternative names and synonyms (up to 10)</li>
                                        <li>Structure visualization URLs (2D/3D images)</li>
                                        <li>Download links for SDF and MOL files</li>
                                        <li>Search metadata and compound identification info</li>
                                    </ul>
                                    <div class="property-example">
                                        <strong>Example Response:</strong>
                                        <pre class="mt-2 mb-0"><code>{
  "cid": 2244,
  "search_info": {
    "original_identifier": "aspirin",
    "identifier_type": "name",
    "search_successful": true
  },
  "basic_properties": {
    "MolecularFormula": "C9H8O4",
    "MolecularWeight": 180.16,
    "XLogP": 1.2,
    "TPSA": 63.6
  },
  "synonyms": ["Acetylsalicylic acid", "Aspirin", ...],
  "image_urls": {
    "2d_structure": "https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244/PNG"
  }
}</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="card endpoint-card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-info method-badge me-2">GET</span>
                                        PUG-View Annotations
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/pugview/compound/{cid}/{section}?heading={heading}</code>
                                    </div>
                                    <p class="mt-3">Access PubChem's educational annotations and detailed information.</p>
                                    <small class="text-muted">Available sections: safety, pharmacology, properties. Optional heading parameter for specific data.</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="card endpoint-card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-info method-badge me-2">GET</span>
                                        Available Headings
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/pugview/headings/{topic}</code>
                                    </div>
                                    <p class="mt-3">List available educational headings for safety, pharmacology, or properties.</p>
                                    <small class="text-muted">Topics: safety, pharmacology, properties, or omit for all available headings.</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Search Endpoints -->
                <div class="tab-pane fade" id="search" role="tabpanel">
                    <div class="row g-4">
                        <div class="col-lg-6">
                            <div class="card endpoint-card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-warning method-badge me-2">GET</span>
                                        Chemical Autocomplete
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/autocomplete/{query}?limit={limit}</code>
                                    </div>
                                    <p class="mt-3">Smart chemical name suggestions from PubChem's autocomplete service.</p>
                                    <ul class="mt-2 small">
                                        <li>Default limit: 10 suggestions</li>
                                        <li>Maximum limit: 20 suggestions</li>
                                        <li>Minimum query length: 2 characters</li>
                                        <li>Cached for 1 hour for performance</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="card endpoint-card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-primary method-badge me-2">GET</span>
                                        Enhanced Formula Search
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/pubchem/compound/fastformula/{formula}/cids/JSON</code>
                                    </div>
                                    <p class="mt-3">Search compounds by molecular formula using PubChem's FastFormula endpoint.</p>
                                    <small class="text-muted">Supports exact molecular formula matching with improved speed and accuracy.</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Analytics Endpoints -->
                <div class="tab-pane fade" id="analytics-endpoints" role="tabpanel">
                    <div class="row g-4">
                        <div class="col-lg-6">
                            <div class="card endpoint-card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-success method-badge me-2">GET</span>
                                        Live Analytics Data
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/analytics</code>
                                    </div>
                                    <p class="mt-3">Real-time API usage statistics and metrics.</p>
                                    <small class="text-muted">Includes total requests, recent activity, top endpoints, and database connection status.</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="card endpoint-card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-info method-badge me-2">GET</span>
                                        Analytics Stream
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/analytics/stream</code>
                                    </div>
                                    <p class="mt-3">Server-Sent Events stream for real-time analytics updates.</p>
                                    <small class="text-muted">Live updates every 30 seconds with new request notifications.</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="card endpoint-card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-primary method-badge me-2">GET</span>
                                        Live Dashboard
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/dashboard</code>
                                    </div>
                                    <p class="mt-3">Interactive HTML dashboard with real-time analytics visualization.</p>
                                    <small class="text-muted">Complete analytics interface with live request tracking and usage statistics.</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="card endpoint-card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <span class="badge bg-secondary method-badge me-2">GET</span>
                                        Monthly Reports
                                    </h5>
                                    <div class="code-block">
                                        <code>GET /api/analytics/monthly/{YYYY-MM}</code>
                                    </div>
                                    <p class="mt-3">Monthly analytics summaries (requires database connection).</p>
                                    <small class="text-muted">Detailed monthly usage reports with request breakdowns and averages.</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Examples Section -->
    <section id="examples" class="py-5">
        <div class="container">
            <h2 class="text-center mb-5">
                <i class="fas fa-code-branch text-primary me-2"></i>
                Practical Usage Examples
            </h2>

            <div class="row g-4">
                <div class="col-lg-6">
                    <div class="card h-100">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="fas fa-graduation-cap me-2"></i>Get Educational Data</h5>
                        </div>
                        <div class="card-body">
                            <h6>Fetch comprehensive educational data for aspirin:</h6>
                            <div class="code-block">
                                <code>GET /api/pubchem/compound/aspirin/educational?type=name</code>
                            </div>
                            <div class="mt-3">
                                <strong>JavaScript Example:</strong>
                                <pre class="bg-light p-2 rounded mt-2"><code>const response = await fetch('/api/pubchem/compound/aspirin/educational?type=name');
const data = await response.json();
console.log(`Formula: ${data.basic_properties.MolecularFormula}`);
console.log(`Synonyms: ${data.synonyms.join(', ')}`);</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="card h-100">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0"><i class="fas fa-search me-2"></i>Smart Autocomplete</h5>
                        </div>
                        <div class="card-body">
                            <h6>Get intelligent chemical name suggestions:</h6>
                            <div class="code-block">
                                <code>GET /api/autocomplete/caffe?limit=5</code>
                            </div>
                            <div class="mt-3">
                                <strong>JavaScript Example:</strong>
                                <pre class="bg-light p-2 rounded mt-2"><code>const response = await fetch('/api/autocomplete/caffe?limit=5');
const data = await response.json();
console.log('Suggestions:', data.suggestions);
// Output: ["caffeine", "caffeic acid", ...]</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="card h-100">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0"><i class="fas fa-chart-line me-2"></i>Live Analytics</h5>
                        </div>
                        <div class="card-body">
                            <h6>Monitor API usage in real-time:</h6>
                            <div class="code-block">
                                <code>GET /api/analytics/stream</code>
                            </div>
                            <div class="mt-3">
                                <strong>JavaScript Example:</strong>
                                <pre class="bg-light p-2 rounded mt-2"><code>const eventSource = new EventSource('/api/analytics/stream');
eventSource.onmessage = function(event) {
  const data = JSON.parse(event.data);
  console.log('Analytics update:', data);
};</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="card h-100">
                        <div class="card-header bg-warning text-dark">
                            <h5 class="mb-0"><i class="fas fa-flask me-2"></i>Formula Search</h5>
                        </div>
                        <div class="card-body">
                            <h6>Search by exact molecular formula:</h6>
                            <div class="code-block">
                                <code>GET /api/pubchem/compound/fastformula/C9H8O4/cids/JSON</code>
                            </div>
                            <div class="mt-3">
                                <strong>JavaScript Example:</strong>
                                <pre class="bg-light p-2 rounded mt-2"><code>const response = await fetch('/api/pubchem/compound/fastformula/C9H8O4/cids/JSON');
const data = await response.json();
console.log('CIDs:', data.IdentifierList.CID);</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Citations Section -->
    <section id="citations" class="py-5 bg-light">
        <div class="container">
            <h2 class="text-center mb-5">
                <i class="fas fa-quote-right text-primary me-2"></i>
                Citations & Attribution
            </h2>

            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="citation-box">
                        <h4 class="mb-3">
                            <i class="fas fa-book me-2"></i>
                            How to Cite This API
                        </h4>
                        <p class="mb-3">
                            When using this educational proxy API in research, publications, or educational materials, 
                            please cite both this software and the underlying PubChem database:
                        </p>
                        
                        <div class="row g-4">
                            <div class="col-md-6">
                                <h5>This API Software:</h5>
                                <div class="bg-white p-3 rounded border">
                                    <strong>APA Format:</strong><br>
                                    Bazarkulov, A. (2025). <em>moleXa API: PubChem Educational Proxy API</em> (Version 2.0.0) [Computer software]. 
                                    GitHub. <a href="https://github.com/bazarkua/molexa-api" target="_blank" style="color: #0066cc; font-weight: 500;">https://github.com/bazarkua/molexa-api</a>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>PubChem Database:</h5>
                                <div class="bg-white p-3 rounded border">
                                    <strong>Primary Citation:</strong><br>
                                    Kim, S., Chen, J., Cheng, T., Gindulyte, A., He, J., He, S., Li, Q., Shoemaker, B. A., Thiessen, P. A., Yu, B., Zaslavsky, L., Zhang, J., & Bolton, E. E. (2023). PubChem 2023 update. <em>Nucleic Acids Research</em>, 51(D1), D1373–D1380. <a href="https://doi.org/10.1093/nar/gkac956" target="_blank" style="color: #0066cc; font-weight: 500;">https://doi.org/10.1093/nar/gkac956</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- License Section -->
    <section id="license" class="py-5">
        <div class="container">
            <h2 class="text-center mb-5">
                <i class="fas fa-balance-scale text-primary me-2"></i>
                License & Legal
            </h2>

            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card border-0 shadow">
                        <div class="card-body p-4">
                            <h4 class="card-title text-center mb-4">
                                <i class="fab fa-osi me-2"></i>
                                MIT License
                            </h4>
                            
                            <div class="bg-light p-3 rounded mb-4">
                                <strong>Copyright © 2025 Adilbek Bazarkulov</strong>
                            </div>

                            <p>
                                Permission is hereby granted, free of charge, to any person obtaining a copy
                                of this software and associated documentation files (the "Software"), to deal
                                in the Software without restriction, including without limitation the rights
                                to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
                                copies of the Software.
                            </p>

                            <div class="text-center mt-4">
                                <a href="https://opensource.org/licenses/MIT" target="_blank" class="btn btn-outline-primary" style="border-color: #0066cc; color: #0066cc;">
                                    <i class="fas fa-external-link-alt me-2"></i>
                                    View Full MIT License
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-6">
                    <h5>
                        <img src="/public/android-chrome-192x192.png" alt="moleXa Logo" style="width: 48px; height: 48px; margin-right: 10px; vertical-align: middle;">
                        moleXa Educational Proxy
                    </h5>
                    <p class="text-light">
                        Enhanced access to PubChem molecular data with educational context, smart search,
                        and real-time analytics for chemistry education and research.
                    </p>
                </div>
                <div class="col-lg-3">
                    <h6>Quick Links</h6>
                    <ul class="list-unstyled">
                        <li><a href="#overview">Overview</a></li>
                        <li><a href="#analytics">Live Analytics</a></li>
                        <li><a href="#endpoints">API Endpoints</a></li>
                        <li><a href="#examples">Examples</a></li>
                    </ul>
                </div>
                <div class="col-lg-3">
                    <h6>Resources</h6>
                    <ul class="list-unstyled">
                        <li><a href="https://pubchem.ncbi.nlm.nih.gov" target="_blank">PubChem Database</a></li>
                        <li><a href="https://pubchem.ncbi.nlm.nih.gov/docs/pug-rest" target="_blank">PUG-REST Docs</a></li>
                        <li><a href="https://github.com/bazarkua/molexa-api" target="_blank">GitHub Repository</a></li>
                    </ul>
                </div>
            </div>
            <hr class="text-light">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <p class="mb-0 text-light">
                        &copy; 2025 Adilbek Bazarkulov. Licensed under MIT License.
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="mb-0 text-light">
                        Built for educational purposes with <i class="fas fa-heart" style="color: #ff69b4;"></i>
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    
    <!-- Enhanced Live Analytics JavaScript -->
    <script>
        // Global analytics state with better persistence
        let analyticsData = {
            totalRequests: 0,
            recentRequests: [],
            requestsByType: {},
            connected: false,
            // 🔧 NEW: Cumulative counters that don't reset
            cumulativeCounts: {
                search: 0,
                educational: 0,
                images: 0
            }
        };
        
        let eventSource = null;
        
        // API Base URL - determine if we're on the API domain or need full URL
        const API_BASE_URL = window.location.hostname.includes('molexa-api.vercel.app') 
            ? '' // Use relative URLs if on API domain
            : 'https://molexa-api.vercel.app'; // Use full URL if on different domain
            
        console.log(`🌐 API Base URL: ${API_BASE_URL || 'relative URLs'} (hostname: ${window.location.hostname})`);
        
        // Initialize analytics
        async function initializeAnalytics() {
            try {
                // Load initial analytics data
                const analyticsUrl = `${API_BASE_URL}/api/analytics`;
                console.log(`📊 Loading analytics from: ${analyticsUrl}`);
                
                const response = await fetch(analyticsUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                console.log('📊 Initial analytics data:', data);
                
                updateAnalytics(data);
                
                // Handle initial recent requests if present
                if (data.recentRequests) {
                    updateRecentRequests(data.recentRequests);
                } else {
                    // Still try to calculate counts with any existing data
                    updateRequestTypeCounts();
                }
                
                updateConnectionStatus(true);
                
                // Start SSE connection
                startEventStream();
                
            } catch (error) {
                console.error('Failed to load analytics:', error);
                updateConnectionStatus(false);
                showConnectionAlert();
                showConnectionError();
                
                // Try again after 30 seconds
                setTimeout(() => {
                    console.log('🔄 Retrying analytics initialization...');
                    initializeAnalytics();
                }, 30000);
            }
        }
        
        function startEventStream() {
            try {
                const streamUrl = `${API_BASE_URL}/api/analytics/stream`;
                console.log(`🔌 Connecting to analytics stream: ${streamUrl}`);
                
                eventSource = new EventSource(streamUrl);
                
                eventSource.onopen = function() {
                    console.log('✅ Connected to analytics stream');
                    updateConnectionStatus(true);
                    hideConnectionAlert();
                };
                
                eventSource.onmessage = function(event) {
                    try {
                        const data = JSON.parse(event.data);
                        console.log('📡 Received analytics update:', data.type, data);
                        
                        if (data.type === 'initial' || data.type === 'update') {
                            if (data.analytics) {
                                updateAnalytics(data.analytics);
                            }
                            if (data.recentRequests) {
                                updateRecentRequests(data.recentRequests);
                            } else {
                                // If no recent requests in this update, still recalculate counts with existing data
                                updateRequestTypeCounts();
                            }
                        }
                    } catch (error) {
                        console.error('Error parsing analytics data:', error);
                    }
                };
                
                eventSource.onerror = function(event) {
                    console.log('❌ Analytics stream error:', event);
                    updateConnectionStatus(false);
                    showConnectionAlert();
                    
                    // Close the connection and try to reconnect after 10 seconds
                    if (eventSource) {
                        eventSource.close();
                        eventSource = null;
                    }
                    
                    setTimeout(() => {
                        console.log('🔄 Attempting to reconnect analytics stream...');
                        startEventStream();
                    }, 10000);
                };
                
            } catch (error) {
                console.error('Failed to start event stream:', error);
                updateConnectionStatus(false);
                showConnectionAlert();
                
                // Try again after 15 seconds if initial connection fails
                setTimeout(() => {
                    console.log('🔄 Retrying analytics stream connection...');
                    startEventStream();
                }, 15000);
            }
        }
        
        function updateConnectionStatus(connected) {
            analyticsData.connected = connected;
            
            // Update status indicators
            const statusDots = document.querySelectorAll('.status-dot, #statusDot, #activityStatusDot');
            const statusBadge = document.getElementById('statusBadge');
            const streamStatus = document.getElementById('streamStatus');
            
            statusDots.forEach(dot => {
                if (connected) {
                    dot.style.backgroundColor = '#28a745';
                    dot.classList.add('pulse');
                } else {
                    dot.style.backgroundColor = '#dc3545';
                    dot.classList.remove('pulse');
                }
            });
            
            if (statusBadge) {
                statusBadge.textContent = connected ? 'Online' : 'Offline';
                statusBadge.className = connected ? 'badge bg-success fs-6 px-3 py-2' : 'badge bg-danger fs-6 px-3 py-2';
            }
            
            if (streamStatus) {
                streamStatus.textContent = connected ? 'Live' : 'Disconnected';
            }
        }
        
        function showConnectionAlert() {
            const alert = document.getElementById('connectionAlert');
            if (alert) {
                alert.classList.remove('d-none');
            }
        }
        
        function hideConnectionAlert() {
            const alert = document.getElementById('connectionAlert');
            if (alert) {
                alert.classList.add('d-none');
            }
        }
        
        function updateAnalytics(analytics) {
            const previousTotal = analyticsData.totalRequests;
            analyticsData.totalRequests = analytics.totalRequests || 0;
            analyticsData.requestsByType = analytics.topTypes ? Object.fromEntries(analytics.topTypes) : {};
            
            // 🔧 FIX: Update cumulative counters from the backend data directly
            if (analytics.topTypes) {
                const typeMap = Object.fromEntries(analytics.topTypes);
                
                analyticsData.cumulativeCounts.search = 
                    (typeMap['Autocomplete'] || 0) + 
                    (typeMap['Name Search'] || 0) + 
                    (typeMap['Formula Search'] || 0);
                    
                analyticsData.cumulativeCounts.educational = 
                    (typeMap['Educational Overview'] || 0) + 
                    (typeMap['Educational Annotations'] || 0);
                    
                analyticsData.cumulativeCounts.images = 
                    (typeMap['Structure Image'] || 0) + 
                    (typeMap['Structure File'] || 0);
            }
            
            // Update main stats
            document.getElementById('totalRequests').textContent = analyticsData.totalRequests;
            document.getElementById('heroTotalRequests').textContent = analyticsData.totalRequests;
            
            // Update the specific counters with cumulative data
            document.getElementById('searchRequests').textContent = analyticsData.cumulativeCounts.search;
            document.getElementById('educationalRequests').textContent = analyticsData.cumulativeCounts.educational;
            document.getElementById('imageRequests').textContent = analyticsData.cumulativeCounts.images;
            
            console.log(`📊 Updated analytics: Total=${analyticsData.totalRequests}, Search=${analyticsData.cumulativeCounts.search}, Educational=${analyticsData.cumulativeCounts.educational}, Images=${analyticsData.cumulativeCounts.images}`);
            
            // Update request types breakdown
            updateRequestTypesDisplay();
        }
        
        function updateRequestTypeCounts() {
            const recentRequests = analyticsData.recentRequests || [];
            console.log(`📊 Calculating counts from ${recentRequests.length} recent requests`, recentRequests.slice(0, 3));
            
            const searchCount = recentRequests.filter(r => {
                const type = (r.type || '').toLowerCase();
                const endpoint = (r.endpoint || '').toLowerCase();
                return type.includes('autocomplete') || 
                       type.includes('search') ||
                       type.includes('name search') ||
                       endpoint.includes('autocomplete') ||
                       endpoint.includes('/compound/name/') ||
                       endpoint.includes('/compound/fastformula/');
            }).length;
            
            const educationalCount = recentRequests.filter(r => {
                const type = (r.type || '').toLowerCase();
                const endpoint = (r.endpoint || '').toLowerCase();
                return type.includes('educational') ||
                       endpoint.includes('educational') ||
                       endpoint.includes('/pugview/');
            }).length;
            
            const imageCount = recentRequests.filter(r => {
                const type = (r.type || '').toLowerCase();
                const endpoint = (r.endpoint || '').toLowerCase();
                return type.includes('image') ||
                       type.includes('structure') ||
                       endpoint.includes('.png') ||
                       endpoint.includes('.PNG') || // 🔧 FIX: Check both cases
                       endpoint.includes('.jpg') ||
                       endpoint.includes('.svg');
            }).length;
            
            console.log(`📊 Counts: Search=${searchCount}, Educational=${educationalCount}, Images=${imageCount}`);
            
            // 🔧 FIX: Only update if we have data, preserve existing counts if no recent data
            if (recentRequests.length > 0) {
                document.getElementById('searchRequests').textContent = searchCount;
                document.getElementById('educationalRequests').textContent = educationalCount;
                document.getElementById('imageRequests').textContent = imageCount;
            } else {
                // If no recent requests, try to maintain existing counts or set to 0
                const currentSearch = parseInt(document.getElementById('searchRequests').textContent) || 0;
                const currentEducational = parseInt(document.getElementById('educationalRequests').textContent) || 0;
                const currentImages = parseInt(document.getElementById('imageRequests').textContent) || 0;
                
                console.log(`📊 No recent requests, maintaining: Search=${currentSearch}, Educational=${currentEducational}, Images=${currentImages}`);
            }
        }
        
        function updateRequestTypesDisplay() {
            const container = document.getElementById('requestTypes');
            const types = analyticsData.requestsByType;
            
            if (Object.keys(types).length === 0) {
                container.innerHTML = '<div class="text-center text-muted"><p>No request data available</p></div>';
                return;
            }
            
            container.innerHTML = Object.entries(types).slice(0, 5).map(([type, count]) => `
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-truncate small">${type}</span>
                    <span class="badge bg-primary">${count}</span>
                </div>
            `).join('');
        }
        
        function updateRecentRequests(requests) {
            console.log(`📝 Updating recent requests:`, requests?.length || 0, requests?.slice(0, 2));
            analyticsData.recentRequests = requests || [];
            const feed = document.getElementById('activityFeed');
            
            if (requests.length === 0) {
                feed.innerHTML = `
                    <div class="text-center text-muted">
                        <i class="fas fa-hourglass-half fa-2x mb-3"></i>
                        <p>Waiting for API requests...</p>
                        <small>Only actual API usage is tracked (PubChem requests, autocomplete, etc.)</small>
                    </div>
                `;
                // Still update counts even with empty data
                updateRequestTypeCounts();
                return;
            }
            
            feed.innerHTML = requests.slice(0, 10).map(request => 
                createRequestElement(request).outerHTML
            ).join('');
            
            // Always update counts after setting recent requests
            updateRequestTypeCounts();
        }
        
        function showConnectionError() {
            const feed = document.getElementById('activityFeed');
            feed.innerHTML = `
                <div class="text-center text-muted">
                    <i class="fas fa-exclamation-triangle fa-2x mb-3 text-warning"></i>
                    <p>Unable to connect to live analytics</p>
                    <small>Analytics stream is temporarily unavailable. Showing last known data.</small>
                </div>
            `;
        }
        
        function createRequestElement(request) {
            const div = document.createElement('div');
            div.className = 'recent-request';
            
            const timeAgo = new Date(request.timestamp).toLocaleTimeString();
            const typeColor = getTypeColor(request.type);
            const method = request.method || 'GET';
            
            div.innerHTML = `
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">
                        <div class="d-flex align-items-center mb-1">
                            <span class="badge ${typeColor} badge-request-type me-2">${request.type || 'API Request'}</span>
                            <small class="text-muted">${timeAgo}</small>
                        </div>
                        <div class="small text-truncate" style="max-width: 300px;">
                            <span class="badge bg-secondary me-1">${method}</span>
                            ${request.endpoint || '/api/unknown'}
                        </div>
                    </div>
                    <i class="fas fa-globe text-muted"></i>
                </div>
            `;
            
            return div;
        }
        
        function getTypeColor(type) {
            const colors = {
                'Educational Overview': 'bg-primary',
                'Autocomplete': 'bg-success',
                'Name Search': 'bg-info',
                'Structure Image': 'bg-warning text-dark',
                'Educational Annotations': 'bg-purple',
                'Properties': 'bg-secondary'
            };
            return colors[type] || 'bg-light text-dark';
        }
        
        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Update active nav link on scroll
        window.addEventListener('scroll', function() {
            let current = '';
            const sections = document.querySelectorAll('section[id]');
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            document.querySelectorAll('.navbar-nav .nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        });
        
        // Initialize analytics when page loads
        document.addEventListener('DOMContentLoaded', initializeAnalytics);
        
        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            if (eventSource) {
                eventSource.close();
            }
        });
    </script>
</body>
</html>